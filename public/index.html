<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>WebSocket —Ç–µ—Å—Ç</title>
</head>
<body>
    <h1>WebSocket —Ç–µ—Å—Ç</h1>
    <input id="msg" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç">
    <button id="send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <div id="log" style="border:1px solid #000; height:200px; overflow:auto;"></div>

    <script>
        const ws = new WebSocket(`ws://${location.host}`);
        const log = document.getElementById('log');
        const input = document.getElementById('msg');
        const btn = document.getElementById('send');

        function addLog(text) {
            const div = document.createElement('div');
            div.textContent = text;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }

        ws.onopen = () => addLog('üîó –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
        ws.onmessage = (e) => {
            try {
                const data = JSON.parse(e.data);
                addLog(`[${data.type}] ${data.text || e.data}`);
            } catch {
                addLog(`–ü–æ–ª—É—á–µ–Ω–æ: ${e.data}`);
            }
        };

        btn.onclick = () => {
            const text = input.value.trim();
            if (text) {
                ws.send(JSON.stringify({ type: 'chat', text }));
                input.value = '';
            }
        };
    </script>
</body>
</html>